/* (Note: This is a valid Java source file)

Dagger 2 Hello World
===

This project is a single file Hello World Dagger-2 Maven project for
Java 8 and later.  The idea was to demonstrate the minimal amount of work
required as the official documentation at
https://google.github.io/dagger/users-guide is targetted towards more
experienced programmers. In other words this is _not_ a tutorial.

The major difference between Dagger  and most other Dependency Injection frameworks
is that Dagger does all its heavy lifting in the compilation phase instead of at runtime.
This mean that Dagger can report problems as compilation errors instead of failing
at startup time.

This file contains the absolute minimal amount of code needed for a full Dagger enabled 
Maven command line application:

1. An interface belonging to our code that Dagger can created injected instances of.

1. A "module" describing how to create those objects Dagger cannot create by itself.

1. A "component" is an interface with a method for getting instances of our interface 
   annotated with the modules Dagger needs.  During compilation 
   Dagger figures out how to wire things together and writes
   the Java source files needed.

1. A main method showing how to wire things together. 

This file is both the Java source file as well as valid Markdown.  It is an
experiment in seeing if the Literate Programming principles can be made usable with 
Java which doesn't have a preprocessor.  The `/*` at the end of a code snippet
is necessary to do this.

## Getting the code to run:

This code has been tested with Intellij 2017 (File -> Open), Eclipse 4.6.3 (File->
Import... -> Maven -> Existing Maven Projects ; Eclipse _must_ have
annotation processing enabled - see below) and Netbeans 8.2 on Ubuntu
17.04.

If the Dagger classes are not automatically generated by the IDE when
opened (happens with older versions of IntelliJ and Eclipse without
m2e-apt enabled), run

    mvn clean package

To run from the command line:

    mvn -q exec:java

Note: Eclipse requires having annotation processor support installed
and enabled!  The m2e-apt plugin can be downloaded from the Eclipse
Marketplace or https://marketplace.eclipse.org/content/m2e-apt (which
also has configuration instructions).  Ensure that Preferences ->
Maven -> Annotation Processing is set to "Automatically configure JDT
APT" or this will not work.

## Main.java

First we define the `HelloWorld` interface which is what our code
is concerned about.  All the rest of the code is for helping Dagger to
create an object implementing this interface so we can invoke its
methods with all injections in place.  This interface only contains a
single method but may contain many.


```
/* interface part */
package demo;

interface HelloWorld { // Our work unit.
    String getMessage();
}

/*
```

Dagger can automatically create an object it needs if its
constructor has a `@Inject` annotation or fields with `@Inject`
annotations.  For other objects Dagger use one or more modules (each
annotated with `@Module`) which contain methods each return one of the
needed objects.  These methods are called providers and are annotated
with `@Provides`.  These methods can take arguments (but doesn't in
this example) which Dagger recursively does the same with to satisfy.


```
/* .... */

@dagger.Module // What help does Dagger need?
class HelloWorldModule {
    @dagger.Provides
    HelloWorld provideHelloWorld() {
        return () -> "Hello World";
    }
}

/*
```

The `@Component` part describes the actual interface Dagger is to
provide a functional instance of, as well as the modules that Dagger
should use to do so.  Modules not indicated here are not considered.
Methods in here are the one Dagger starts with to figure out the
dependency tree.

The `main(...)` method invokes the source automatically generated
by Dagger during compilation to get a component where the methods
return objects created by Dagger.  The `helloWorld()` method is
invoked to get an object implementing the `HelloWorld` interface,
where the `getMessage()` method returns "Hello World".

```
/* .... */

public class Main {
    // What do we need Dagger to build?
    @dagger.Component(modules = HelloWorldModule.class)
    interface HelloWorldComponent {
        HelloWorld helloWorld();
    }

    public static void main(String[] args) throws Exception {
        // If compilation fails, see README.md
        HelloWorldComponent daggerGeneratedComponent = DaggerMain_HelloWorldComponent.builder().build();

        HelloWorld helloWorld = daggerGeneratedComponent.helloWorld();
        System.out.println(helloWorld.getMessage());
    }
}
